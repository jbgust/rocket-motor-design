<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

    <script src="https://www.amcharts.com/lib/4/core.js"></script>
    <script src="https://www.amcharts.com/lib/4/charts.js"></script>
    <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>


    <style lang="css">
       body {
          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        }
        span {
            margin-left: 20px;
        }
    </style>

</head>
    <body>

    <div style="flex-direction:row; display:flex; margin: 10px;">
        <div style="margin-right: 40px;">
            <form th:action="@{/test}" method="post" th:object="${request}">
                <input th:field="*{throatDiameter}">Throat diameter</input><br>
                <input th:field="*{outerDiameter}">Grain outer diameter</input><br>
                <input th:field="*{coreDiameter}">Grain core diameter</input><br>
                <input th:field="*{segmentLength}">Grain segment length</input><br>
                <input th:field="*{numberOfSegment}">Number of segment</input><br>

                <select th:field="*{outerSurface}" name="outerSurface">
                    <option th:each="i : ${surfaces}" th:value="${i.name}" th:text="${i.name}">
                    </option>
                </select>Outer surface<br>
                <select th:field="*{endsSurface}">
                    <option th:each="i : ${surfaces}" th:value="${i.name}" th:text="${i.name}">
                    </option>
                </select>Ends surface<br>
                <select th:field="*{coreSurface}">
                    <option th:each="i : ${surfaces}" th:value="${i.name}" th:text="${i.name}">
                    </option>
                </select>Core surface<br>

                <select th:field="*{propellantType}">
                    <option th:each="i : ${propellants}" th:value="${i.name}" th:text="${i.name}">
                    </option>
                </select>Propellant<br>

                <input th:field="*{chamberInnerDiameter}">Chamber inner diameter</input><br>
                <input th:field="*{chamberLength}">Chamber length</input><br>
                <input type="submit" name="toto">

            </form>
            <div style="padding:10px; margin-top: 20px; border: 1px solid black;" th:if="${error==null}">
                <h3 style="margin-bottom:5px;margin-top:0px;">Performance</h3>
                <span style="font-weight: bold;">Class : </span><span th:text="${performance.motorDescription}"></span><br>
                <span style="font-weight: bold;">Thrust time : </span><span th:text="${performance.thrustTime}"></span><br>
                <span style="font-weight: bold;">Max thrust : </span><span th:text="${performance.maxThrust}"></span><br>
                <span style="font-weight: bold;">Total impulse : </span><span th:text="${performance.totalImpulse}"></span><br>
                <span style="font-weight: bold;">Isp : </span><span th:text="${performance.specificImpulse}"></span><br>
                <span style="font-weight: bold;">Max pressure : </span><span th:text="${performance.maxPressure}"></span><br>
                <h3 style="margin-bottom:5px;">Nozzle</h3>
                <span style="font-weight: bold;color: orange;" th:if="${performance.optimalDesign}">Optimal design</span><br th:if="${performance.optimalDesign}">
                <span style="font-weight: bold;">Nozzle exit diam. : </span><span th:text="${performance.nozzleExitDiameter}"></span><br>
                <span style="font-weight: bold;">Longueur divergent : </span><span th:text="${performance.divergenceLenght}"></span><br>
                <span style="font-weight: bold;">Longueur convergent : </span><span th:text="${performance.convergenceLenght}"></span><br>
                <span style="font-weight: bold;">Vitesse sortie initiale : </span><span th:text="${performance.exitSpeedInitial}"></span><br>
            </div>
        </div>
        <div>
            <p th:if="${error!=null}" style="color:red; font-size:24px;">Simulation failed</p>
            <textarea th:if="${error!=null}"th:text="${error}" readonly cols="130" rows="50"></textarea>


            <div id="chartdiv" style="height:600px;"></div>

        </div>
    </div>




    <script th:if="${error==null}" th:inline="javascript">
        /**
 * ---------------------------------------
 * This demo was created using amCharts 4.
 *
 * For more information visit:
 * https://www.amcharts.com/
 *
 * Documentation is available at:
 * https://www.amcharts.com/docs/v4/
 * ---------------------------------------
 */

// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end

// Create chart instance
var chart = am4core.create("chartdiv", am4charts.XYChart);
chart.paddingRight = 20;

// Add data
chart.data = [[${results}]];

// Create axes
var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
categoryAxis.dataFields.category = "timeSinceBurnStartInSecond";
categoryAxis.renderer.minGridDistance = 50;
categoryAxis.renderer.grid.template.location = 0.5;
categoryAxis.startLocation = 0.5;
categoryAxis.endLocation = 0.5;


// Create value axis
var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
valueAxis.baseValue = 0;

// Create series
var series = chart.series.push(new am4charts.LineSeries());
series.dataFields.valueY = "thrustInNewton";
series.dataFields.categoryX = "timeSinceBurnStartInSecond";
series.strokeWidth = 2;
series.tensionX = 12;

chart.cursor = new am4charts.XYCursor();
    </script>
    </body>
</html>